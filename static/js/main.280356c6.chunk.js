(window["webpackJsonpreact-hex"]=window["webpackJsonpreact-hex"]||[]).push([[0],{12:function(e,t,n){e.exports=n(24)},17:function(e,t,n){},18:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),l=n(9),o=n.n(l),r=(n(17),n(10)),s=n(3),c=n(4),u=n(6),h=n(5),d=n(2),p=n(7),v=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).element=i.a.createRef(),n.el=void 0,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){void 0!==this.props.onClick&&(this.el=this.element.current,this.el.addEventListener("click",this.props.onClick.bind(this)))}},{key:"componentWillUnmount",value:function(){void 0!==this.el&&this.el.removeEventListener("click",this.props.onClick.bind(this)),this.el=void 0}},{key:"makeHexagon",value:function(e){return i.a.createElement("path",{key:"hexagon",stroke:"none",mask:"url(#"+e+")",fill:this.colour,strokeWidth:this.strokeWidth,d:"M1.00 0.00L0.50 0.87L-0.50 0.87L-1.00 0.00L-0.50 -0.87L0.50 -0.87Z"})}},{key:"makeFlag",value:function(){return i.a.createElement("path",{key:"flag",d:"M-0.5 0.5L0.5 -0.5M0.5 0.5L-0.5 -0.5",stroke:"black",strokeLinecap:"round",strokeWidth:this.strokeWidth})}},{key:"makeBomb",value:function(){return i.a.createElement("path",{key:"bomb",d:"M0 0.6L0 -0.6M0.52 0.3 L-0.52 -0.3M-0.52 0.3 L0.52 -0.3",stroke:"black",strokeLinecap:"round",strokeWidth:this.strokeWidth})}},{key:"makeBombCount",value:function(){for(var e=[],t=0;t<this.count;t++){var n=180+360*t/this.count;e.push(i.a.createElement("path",{d:"M0 0.4L-0.15 0.1L0.15 0.1Z",key:t,transform:"rotate(".concat(n,")"),stroke:"black",strokeWidth:this.strokeWidth}))}return i.a.createElement("g",{key:"bomb count"},e)}},{key:"makeCircle",value:function(){return i.a.createElement("circle",{r:.5,cx:0,cy:0,key:0,fill:"none",stroke:"black",strokeWidth:this.strokeWidth})}},{key:"render",value:function(){var e=[i.a.createElement("rect",{key:"bg",x:"-2",y:"-2",width:"4",height:"4",fill:"white"})],t="cell",n="circleMask_".concat(this.q,"_").concat(this.r,"_").concat(Math.random());this.flagged?(e.push(this.makeFlag()),e.push(this.makeCircle()),t+=" flagged"):this.revealed&&(t+=" revealed",this.isBomb?(t+=" bomb",e.push(this.makeBomb())):(e.push(this.makeCircle()),e.push(this.makeBombCount())));var a=[this.makeHexagon(n),i.a.createElement("mask",{key:"mask",id:n},e)],l=this.scale;return this.exploded&&(l*=.5),i.a.createElement("g",{ref:this.element,className:t,style:{cursor:"pointer"},transform:"translate(".concat(this.position.join(","),"), scale(").concat(l,")")},a)}},{key:"q",get:function(){return this.props.q||0}},{key:"r",get:function(){return this.props.r||0}},{key:"revealed",get:function(){return void 0!==this.props.revealed&&this.props.revealed}},{key:"flagged",get:function(){return void 0!==this.props.flagged&&this.props.flagged}},{key:"exploded",get:function(){return void 0!==this.props.exploded&&this.props.exploded}},{key:"count",get:function(){return void 0!==this.props.count?this.props.count:0}},{key:"isBomb",get:function(){return this.count<0}},{key:"colour",get:function(){return void 0!==this.props.colour?this.props.colour:"white"}},{key:"position",get:function(){return void 0!==this.props.position?this.props.position:[0,0]}},{key:"scale",get:function(){return void 0!==this.props.scale?this.props.scale:1}},{key:"strokeWidth",get:function(){return void 0!==this.props.strokeWidth?this.props.strokeWidth:.15*this.scale}}]),t}(i.a.Component),g=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.scale*Math.sqrt(3)*(2*this.radius+1+2*this.padding),n="-".concat(t/2," -").concat(t/2," ").concat(t," ").concat(t),a=Object.values(this.props.cells).map((function(t){var n=t.q,a=t.r,l=n+","+a,o=3*e.scale/2*n,r=e.scale*(Math.sqrt(3)*a+Math.sqrt(3)/2*n);return i.a.createElement(v,Object.assign({key:l},t,{colour:e.getColour(t,e.radius),position:[o,r],scale:e.innerScale,onClick:function(){return e.onActivate(l)}}))}));return i.a.createElement("svg",{viewBox:n,className:"hueRotate"},i.a.createElement("g",null,a))}},{key:"getColour",get:function(){return void 0!==this.props.getColour?this.props.getColour:function(){return"white"}}},{key:"onActivate",get:function(){return void 0!==this.props.onActivate?this.props.onActivate:function(){}}},{key:"scale",get:function(){return void 0!==this.props.scale?this.props.scale:1}},{key:"innerScale",get:function(){return void 0!==this.props.innerScale?this.props.innerScale:.9}},{key:"radius",get:function(){return void 0!==this.props.radius?this.props.radius:2}},{key:"padding",get:function(){return void 0!==this.props.padding?this.props.padding:1}}]),t}(i.a.Component),m=(n(18),n(1)),f=n(11),k=n.n(f);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){return i.a.createElement("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"}},e.children)}function w(e){return i.a.createElement("div",{style:{margin:"0",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i.a.createElement("div",{style:{display:"inline-block"}},e.children))}function O(e){return i.a.createElement("div",{style:{width:"100vmin",height:"100vmin",position:"relative"}},e.children)}function j(e,t,n){var a=.5+.5*e.q/(t+2),i=.5+.5*e.r/(t+2),l=Math.abs(a+i)/2;return e.revealed?(a=1-a,i=1-i,l=1-l,e.count<0&&(a/=2,i/=2,l/=2)):e.flagged&&(a/=2,i/=2,l/=2),"rgb(".concat(255*a,",").concat(255*i,", ").concat(255*l,")")}function x(e){var t=new e.type({size:"2em",color:e.color});return i.a.createElement("div",{className:e.className,style:{display:"inline-block",background:"rgba(0, 0, 0, 0.5)",cursor:"pointer",padding:"0.25em 0.5em"},onClick:e.onClick},t)}function S(e){if(!e.display)return null;var t=null;void 0!==e.cells&&(t=e.cells.map((function(e,t){return i.a.createElement("svg",{key:t,viewBox:"-1 -1 2 2",width:"4em",height:"4em"},i.a.createElement(v,Object.assign({fill:"white",q:0,r:0},e)))})));var n=null;e.next&&(n=i.a.createElement(x,{type:m.h,onClick:function(){return e.next()}}));var a=null;return e.prev&&(a=i.a.createElement(x,{type:m.g,onClick:function(){return e.prev()}})),i.a.createElement("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignContent:"center"}},i.a.createElement("div",{style:{width:"50%",height:"50%",textAlign:"center",marginTop:"auto",marginBottom:"auto"}},t,e.children,i.a.createElement("div",null,a,n)))}var C=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={radius:4,seed:(new Date).getTime(),showHelp:!1,activeTool:"reveal",cells:{},bombRatio:.3,showNext:!1,helpSlide:0},n.toggleHelp=n.toggleHelp.bind(Object(d.a)(n)),n.onActivate=n.onActivate.bind(Object(d.a)(n)),n.startNewGame=n.startNewGame.bind(Object(d.a)(n)),n.setSlide=n.setSlide.bind(Object(d.a)(n)),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"toggleHelp",value:function(){this.setState({helpSlide:0,showHelp:!this.state.showHelp})}},{key:"initiateGame",value:function(){for(var e=new k.a(this.state.seed),t={},n=-this.state.radius;n<=this.state.radius;n++)for(var a=Math.max(-this.state.radius,-n-this.state.radius);a<=Math.min(this.state.radius,-n+this.state.radius);a++)t[n+","+a]={q:n,r:a,count:0,flagged:!1,revealed:!1,exploded:!1};e.pickset(Object.keys(t),Math.floor(this.state.bombRatio*Object.keys(t).length)).forEach((function(e){t[e].count=-1;var n=e.split(",").map((function(e){return parseInt(e)}));[[1,0],[1,-1],[0,-1],[-1,0],[-1,1],[0,1]].forEach((function(e){var a=[n[0]+e[0],n[1]+e[1]].join(",");void 0!==t[a]&&-1!==t[a].count&&(t[a].count+=1)}))})),this.setState({cells:t,showNext:!1})}},{key:"isGameOver",value:function(){for(var e=0,t=0,n=0,a=0,i=0,l=Object.values(this.state.cells);i<l.length;i++){var o=l[i];if(o.count<0&&(e+=1),o.flagged&&o.count>=0)return!1;o.flagged&&o.count<0&&(t+=1),o.revealed||o.flagged||(n+=1),o.revealed&&o.count<0&&(a+=1)}return t+a===e||e-t-a===n}},{key:"onActivate",value:function(e){"reveal"===this.state.activeTool?this.revealCell(e):"flag"===this.state.activeTool&&this.toggleFlag(e),this.isGameOver()&&this.setState({showNext:!0})}},{key:"toggleFlag",value:function(e){var t=y({},this.state.cells);t[e].revealed||(t[e].flagged=!t[e].flagged,this.setState({cells:t}))}},{key:"revealCell",value:function(e){var t=y({},this.state.cells);if(!t[e].revealed&&!t[e].flagged){t[e].revealed=!0,0===t[e].count&&function e(n){[[1,0],[1,-1],[0,-1],[-1,0],[-1,1],[0,1]].forEach((function(a){var i="".concat(n.q+a[0],",").concat(n.r+a[1]),l=t[i];void 0!==l&&!l.revealed&&!l.count>=0&&!l.flagged&&(l.revealed=!0,0===l.count&&e(l))}))}(t[e]),t[e].count<0&&(t[e].exploded=!0,function e(n){[[1,0],[1,-1],[0,-1],[-1,0],[-1,1],[0,1]].forEach((function(a){var i="".concat(n.q+a[0],",").concat(n.r+a[1]),l=t[i];void 0===l||l.revealed||l.flagged||(l.revealed=!0,l.exploded=!0,l.count<0&&e(l))}))}(t[e])),this.setState({cells:t})}}},{key:"setTool",value:function(e){this.setState({activeTool:e})}},{key:"startNewGame",value:function(){var e=this;this.setState({seed:(new Date).getTime()},(function(){e.initiateGame()}))}},{key:"componentDidMount",value:function(){document.body.addEventListener("touchmove",(function(e){e.preventDefault()})),this.initiateGame()}},{key:"setSlide",value:function(e){this.setState({helpSlide:e})}},{key:"render",value:function(){var e=this,t=null;this.state.showHelp&&(t=i.a.createElement("div",{style:{position:"absolute",top:0,background:"black",width:"100%",height:"100%"}},i.a.createElement(S,{display:0==this.state.helpSlide,cells:[{}],next:function(){return e.setSlide(1)}},i.a.createElement("div",null,'This is an "unrevealed" cell. It may or may not be hiding a bomb. You can reveal the contents of a cell by clicking/tapping it. The goal of this game is to either flag all unrevealed bombs, or to reveal all non-bomb cells.')),i.a.createElement(S,{display:1==this.state.helpSlide,cells:[{revealed:!0,count:0,flagged:!1},{revealed:!0,count:1,flagged:!1},{revealed:!0,count:2,flagged:!1},{revealed:!0,count:3,flagged:!1},{revealed:!0,count:4,flagged:!1},{revealed:!0,count:5,flagged:!1},{revealed:!0,count:6,flagged:!1,scale:1}],prev:function(){return e.setSlide(0)},next:function(){return e.setSlide(2)}},i.a.createElement("div",null,'These are "revealed" cells that didn\'t hide a bomb. The shape inside the cell indicates the number of bomb in the neighbouring cells, from 0 to 6. In general, the number of triangles indicates the number of neighbours with bomb. Using these, you can sometimes deduce if a specific neighbour hides a bomb.')),i.a.createElement(S,{display:2==this.state.helpSlide,cells:[{revealed:!1,count:0,flagged:!0}],prev:function(){return e.setSlide(1)},next:function(){return e.setSlide(3)}},i.a.createElement("div",null,'This is a "flagged" cell. You can flag cells by clicking the ',i.a.createElement("span",null,i.a.createElement(m.d,null)),' icon in the bottom left. This will switch to "flag" mode, and any cells you click/tap will be flagged. You can return to "reveal" mode by clickgin the ',i.a.createElement("span",null,i.a.createElement(m.c,null))," button also in the bottom left.")),i.a.createElement(S,{display:3==this.state.helpSlide,cells:[{revealed:!0,count:-1,flagged:!1}],prev:function(){return e.setSlide(2)},next:function(){return e.setSlide(4)}},i.a.createElement("div",null,'This is a revealed "bomb" cell. They will reveal and "explode" neighbouring cells. This can lead to a chain reaction! Exploded cells will appear as small cells.')),i.a.createElement(S,{display:4==this.state.helpSlide,prev:function(){return e.setSlide(3)}},i.a.createElement("div",null,"You can start a new game by clicking the ",i.a.createElement("span",null,i.a.createElement(m.b,null)),", unless you've finished the current game, in which case you will see the ",i.a.createElement("span",null,i.a.createElement(m.a,null))," button. Either can be located in the center of the bottom right of the screen.")),i.a.createElement(x,{type:m.e,className:"topRight",onClick:this.toggleHelp,color:"white"})));var n=100*Object.values(this.state.cells).reduce((function(e,t,n){return t.exploded?e:e+1}),0)/Object.keys(this.state.cells).length,a=null;return this.state.showNext&&(a=i.a.createElement("div",{className:"top",color:"white"},"score: ",n.toFixed(2),"%")),i.a.createElement("div",{className:"App"},i.a.createElement(E,null,i.a.createElement(w,null,i.a.createElement(O,null,i.a.createElement(g,{innerScale:.9,radius:this.state.radius,cells:this.state.cells,getColour:j,onActivate:this.onActivate})))),i.a.createElement("div",{className:"bottomLeft"},i.a.createElement(x,{type:m.c,onClick:function(){return e.setTool("reveal")},color:"reveal"===this.state.activeTool?"green":"white"}),i.a.createElement(x,{type:m.d,onClick:function(){return e.setTool("flag")},color:"flag"===this.state.activeTool?"green":"white"})),i.a.createElement(x,{type:this.state.showNext?m.a:m.b,className:"bottomRight",onClick:function(){return e.startNewGame()},color:"yellow"}),i.a.createElement(x,{type:m.i,style:{display:"none"},className:"xtopLeft",color:"white"}),i.a.createElement(x,{type:m.f,className:"topRight",onClick:this.toggleHelp,color:"white"}),a,t)}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[12,1,2]]]);
//# sourceMappingURL=main.280356c6.chunk.js.map